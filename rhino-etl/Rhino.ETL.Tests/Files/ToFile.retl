[DelimitedRecord("\t")]
class Customers:
	public OrderID as int
	public CustomerID as string
	public EmployeeID as int

connection( 
	"Database",
	ConnectionType: SqlConnection,
	ConnectionString: "Data Source=localhost;Initial Catalog=ETL_Test; Integrated Security=SSPI;"
	)
	
source OrdersFromDatabase, Connection="Database":
	Command: "SELECT OrderID, CustomerID, EmployeeID FROM Orders"

destination OrdersFile:
	initialize:
		Parameters.File = Write(Customers).To("output.txt")
	onRow:
		cust = Customers( 
			OrderID: Row.OrderID, 
			CustomerID: Row.CustomerID,
			EmployeeID: Row.EmployeeID
			)
		Parameters.File.Write(cust)
	cleanUp:
		Parameters.File.Dispose()

pipeline OutputOrders:
	OrdersFromDatabase >> OrdersFile
	
target default:
	Execute("OutputOrders")