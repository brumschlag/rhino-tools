<?xml version="1.0" encoding="utf-8" ?>
<authorizationRules>
  <rule operation="/account/login" name="administrators can always login">
    <![CDATA[
if Principal.IsInRole("Administrators"):
  Allow("Administrators can always log in")
  return
]]>
  </rule>
  <rule operation="/account/login" name="work hours">
    <![CDATA[
if date.Now.Hour < 9 or date.Now.Hour > 17:
  Deny("Cannot log in outside of business hours, 09:00 - 17:00")
 ]]>
  </rule>
  <rule operation="/order/approve" name="order approval">
    <![CDATA[
if Principal.IsInRole("Managers"):
	Allow("Managers can always approve orders")
	return

if Entity.TotalCost >= 10_000:
	Deny("Only managers can approve orders of more than 10,000")
	
Allow("All users can approve orders less than 10,000")
]]>
  </rule>
</authorizationRules>
